<!-- views/blog.handlebars -->

{{!-- Define the layout to be used --}}
{{#layout 'main'}}
  {{!-- Set the page title --}}
  {{#set 'title'}}{{post.title}}{{/set}}

  {{!-- Render the blog post --}}
  <div>
    <h2>{{post.title}}</h2>
    <p>{{post.content}}</p>
    <p>By: {{post.user.username}}</p>
    <p>Date: {{post.createdAt}}</p>
  </div>
  <hr>

  {{!-- Render the comments --}}
  <h3>Comments</h3>
  {{#each comments}}
    <div>
      <p>{{content}}</p>
      <p>By: {{user.username}}</p>
      <p>Date: {{createdAt}}</p>
    </div>
    <hr>
  {{/each}}

  {{!-- Render the comment form --}}
  {{#if loggedIn}}
    <h3>Add a Comment</h3>
    <form action="/api/comments" method="POST">
      <input type="hidden" name="postId" value="{{post.id}}">
      <textarea name="content" rows="3" required></textarea>
      <button type="submit">Submit</button>
    </form>
  {{else}}
    <p>Please log in to leave a comment.</p>
  {{/if}}

  {{!-- Render the link to go back to the home page --}}
  <p><a href="/">Back to Home</a></p>
{{/layout}}
